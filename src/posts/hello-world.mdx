---
title: 'EXKSM | 网站的诞生'
abstract: 我一直热衷于分享自己的作品到各平台，但是每个平台展现作品的形式都大相径庭。此后我便一直希望能有一个自由存放与展示作品的媒介，因此我便着手打造自己的个人网站。
date: '2022-07-24'
banner: /static/hello-world-banner.jpg
---

## 前言
当我"落笔"敲下这篇文章时，我正传等待GCC 9.3.0版本的漫长编译升级

## 网站的诞生

[404 page](/404).


## 网站的编写
在大学最后一学期的Industrial Year是用ReactJs + PostgreDB 给客户搭建一个数据管理系统，但是当时抱着队员大腿划水，也没学到什么真正的技术；当自己真正开始搭建时，当时的很多疑惑现在才逐渐清晰。

## 服务器的环境搭建
在网站写了10%左右(2022-7-25)，我想把网站打包发布到服务器去看看，结果发现服务器环境需要准备的依赖太多了！

光是我想升级一个18.6.0的Nodejs，便需要升级GBLIC，然而升级GBLIC又需要升级gcc/gdb/make等各种，俄罗斯套娃一般的升级

我不光熟悉了Linux的各种操作命令，还体验了手工编译升级依赖的酸爽

## 实战收获

通过实现一个个人网站，我经历了：
- 服务器与域名
    - 购买域名
    - 域名备案
    - 购买云服务器
    - 服务器备案
    - 服务器环境搭建与更新
    - Logo设计
    - 项目开发、打包、部署


- 学到的新知识：
    - Markdown语法
    - ico文件生成与编辑
    - SVG文件生成与编辑
    - Linux各项操作命令
     - React 与 JavaScript的大部分功能

- 用到的软件：
    - 图形处理：PS / AI
    - 代码编程：Visual Studio Code / Github Desktop


![A scene from Ghost in the Shell (1995) with the Major cloaking with thermoptic camouflage; the poster for Akira; The Matrix's digital rain effect](/static/inspiration.png)

## The first iteration

I was learning React when I first built this website, and while overkill for a personal portfolio site, it was a great opportunity to learn and experiment with learning it. I've found the best way to learn is by actually making something that you intend to use and ship.

The no-brainer choice at the time was Create React App. It served me well in getting things up and running without having to fuss about with config. On top of that, I was using Styled Components, Tween.js, and React Transition Group. I was also playing with some early Three.js effects like the displacement sphere that still resides on the homepage.

Since then I've used this website as a playground for experimenting with new tech and techniques, so over time I've overhauled pretty much everything. A big change along the way was replacing images of my work in static mockups with real-time rendered interactive 3D devices using models I created for the [Clay Mockups 3D Figma plugin](https://www.figma.com/community/plugin/819335598581469537/Clay-Mockups-3D).

![Thumbnail for my Clay Mockups 3D plugin](/static/clay-mockups.png)

## Migrating to Next.js

With Create React App I was using a somewhat janky and unmaintained package to prerender the site as static HTML in Puppeteer. This worked okay for the most part, but I wanted a more robust solution for posting articles (like this one you're reading) using MDX. I had a half baked version of this lying dormant in the repo, but it never felt good enough to publish. I looked at a few options like Gatsby, Vite, and Parcel, and Remix, but Next.js stood out as the most suited to my needs.

- The site is now based on Next.js. Is a much better fit than Create React App. For now I'm just using it to create a static export, but maybe I'll add some server rendered stuff in the future.
- Styling is now vanilla CSS with postcss to add support for the future native CSS nesting and custom media queries features. I'm using CSS modules instead of BEM syntax to avoid style conflicts.
- For generating pages from `.mdx` files, I'm using Kent C Dodds' [mdx-bundler](https://github.com/kentcdodds/mdx-bundler). In combination with Next.js it makes generating pages from `.mdx` files really quick and simple.
- For animation I've moved from Tween.js and React Transition Group to just Framer Motion.
- 3D effects are still all using Three.js, but I've added `three-stdlib` as a better maintained replacement for modules from Three's examples.

## Not all smooth sailing

For the most part, the migration was pretty straight-forward. The way I has structured the site with React Router lent itself well to conforming with Next.js's file-based routing, and I was already using postcss for styling. I did, however, encounter a couple of problems:

### 1. Route transitions

There was a bit of a conflict when it came to animated route transitions. Next.js will immediately yank out all of the styles for the previous page when navigating to a new one. This works great when you're not animating between pages because it cleans up any unused styles form hanging around. When you are animating the page transition though, all of a sudden the previous page becomes jarringly completely unstyled as it transitions out. This problem one of [the most commented and reacted to issues](https://github.com/vercel/next.js/issues/17464) on the Next.js repo, so hopefully there's a fix soon, but for now I've dropped in a [hack to fix things](https://github.com/vercel/next.js/issues/17464#issuecomment-796430107) from the issue's comments.

### 2. Scroll restoration

Somewhat related to the route transitions, I had to opt out of both Next.js's and the native browser's scroll restoration in order to prevent the browser immediately scrolling to the top when the page started transitioning out. Next.js also doesn't appear to handle shifting focus when linking to the id of an element within the page, so I added that in for accessibility.

## Looking back, and forward

It's been pretty neat to see how popular the site's been on Github, with 500 stars (as of writing this post). It's also neat seeing how people adapt it to their own style and modify it, which is part of the reason I made it open source. I want others to be able to take it apart and see how it's made, learn from and improve upon it. That's what inspect element used to be like on the web, but with modern sites compiling and minifying and injecting garbled strings into css classes that's not as simple these days. The next best thing I could do was to open source it.

I look forward to continuing to use this site as a playground, and it'll be interesting to compare the next iteration to where it is today.
